Modified version to support map-icons, different marker colors, etc.